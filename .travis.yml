language: python
python:
  - 3.8
before_install:
  - openssl aes-256-cbc -K $encrypted_fb088dcee1f3_key -iv $encrypted_fb088dcee1f3_iv
    -in secrets.json.enc -out secrets.json -d
install:
  - pip install -r requirements.txt
script:
  - python manage.py test
cache:
  directories:
    - "$HOME/.m2/repository"
    - "$HOME/.gradle"
before_deploy:
  - mkdir -p dpl_cd_upload
  - mv AKIA4W33QLUKQBFDETKM dpl_cd_upload/AKIA4W33QLUKQBFDETKM
deploy:
  - provider: s3
    access_key_id: j3Jo+9vXSWkccc1VAj8KAX8ZbrF9hbQkRMmmbnr8IkVwnJjpCAKFW3mgiaCI8XlsGnL2ujRwlWD6EsFxcFMspgeOsWKLDnQPDUxuYGMzl//YJ5OjJXhLR72RbpRNULLlD1eMLVLnN/WdUkD17m57XClCI/n0o9uLY+03+m5c2ltWrmkuwJ/80bXoNL7S6dedR+WQOA712HiAMxtDXoWBRXXSjM66dxU2OrxLJXBpe/dU7wXAQ6Ft1mn1a+57FMC0do29d/fxFtiqUBDQP0Mt+bey9++hAOF0MFMEN0hp1qa+u0ureUMbL0p7Be5OvhltVwQZhcW4p902L9GuULQ5R1PhbD3ScpsaKGIrZMKYUKuHlKqEew1tLK5RnQO9RSXkmYAkJ2yZ7nzjq4NjAv+tw5G7vEdLmAbRC9x/mMkrnQGUcFghZUzPCEOyUw/fy7Hqh6azduDyPdu359NokUEMbqbasj6sS2q0+B1QnXhKxhFI8hc4eA/Kese7HpdvkmTs15/1ur2sWCVMX+wAYjUYwSm97CH0upLVp6oJhanxnXln9voMTCEQQpplwSJjsodBdZ3+YH3yZxJeqjTgm0l2ybt3T6Iq0Edwa4MRyhC/fK9Leho+JsZ09/F4l3IEGHQYJaNJ7Q6ZlK/i1T83vdpSkL9HJy7hN6c+5ep/H6rOKcg="
    secret_access_key: &1
      secure: vaytseV8dvuqHgp0x2pDAY1dTFu/MP+GTcJj2BxH3XSCTEoPtDl0fnV6T4xkUpXDVSW2b44mEW4gCqGBBW42CpSRLs4ZB7wVmroLvd2TQOX6WQRx6TpyW9LFP4Zf3lf9JKFjE3U9nvXpUrNFwEEOm9E/f/uAaiqm8NxLzRFMzIJGzdvO+Mhd1/tMfeDiGFygYyc7INkmDZ8T1ke84W8kY/iKyqKXpOIMZ5BSvpTdA1tS7laeOEFkjwPcgLOFiYA+OFZHgmNf+JkjoHECTYZLBmp9agClyqikmBsJ9Zp5BD4E6Z8Md3L4sn5KuqvSEH6+fO3qJ1YK8rZQVRbJhEEnHB2BldflQ2LqdtvdNDXTxBFPwbjZR7Y19KBX/vmtv1oVshTb+tVH8zeZRJ+aOL/1Sysm3QCPNmRKYXGq0zc/GnbGoyJLNrI2lI8j1qI8lfrg1vma0FBla2LreqSNh01/X0eBqNPvFy+Vr02PSzTQHwkWbebrpmmzJ5chImLOTts1RafL8S3QODSSfOE+D83b7r0c27Xb2Fh9ZZz9RHca3I0x8hGpRFpQX4wQSJ/HlJblThgGOaDJEwAUAVJeh3q9Pxld8qB/xlUoYyiSqAPbHbnHpxSQyuVV+eb8AO1JaJOMWkVm2KlYkG+Qdr1B7kBD3QA0cM84yEymeEcWogi91GI=
    local_dir: dpl_cd_upload
    skip_cleanup: true
    on: &2
      repo: TourKakao-Carping/Carping-Backend
      branch: main
    bucket: chanjongs
  - provider: codedeploy
    access_key_id: j3Jo+9vXSWkccc1VAj8KAX8ZbrF9hbQkRMmmbnr8IkVwnJjpCAKFW3mgiaCI8XlsGnL2ujRwlWD6EsFxcFMspgeOsWKLDnQPDUxuYGMzl//YJ5OjJXhLR72RbpRNULLlD1eMLVLnN/WdUkD17m57XClCI/n0o9uLY+03+m5c2ltWrmkuwJ/80bXoNL7S6dedR+WQOA712HiAMxtDXoWBRXXSjM66dxU2OrxLJXBpe/dU7wXAQ6Ft1mn1a+57FMC0do29d/fxFtiqUBDQP0Mt+bey9++hAOF0MFMEN0hp1qa+u0ureUMbL0p7Be5OvhltVwQZhcW4p902L9GuULQ5R1PhbD3ScpsaKGIrZMKYUKuHlKqEew1tLK5RnQO9RSXkmYAkJ2yZ7nzjq4NjAv+tw5G7vEdLmAbRC9x/mMkrnQGUcFghZUzPCEOyUw/fy7Hqh6azduDyPdu359NokUEMbqbasj6sS2q0+B1QnXhKxhFI8hc4eA/Kese7HpdvkmTs15/1ur2sWCVMX+wAYjUYwSm97CH0upLVp6oJhanxnXln9voMTCEQQpplwSJjsodBdZ3+YH3yZxJeqjTgm0l2ybt3T6Iq0Edwa4MRyhC/fK9Leho+JsZ09/F4l3IEGHQYJaNJ7Q6ZlK/i1T83vdpSkL9HJy7hN6c+5ep/H6rOKcg="
    secret_access_key: *1
    bucket: chanjongs
    key: aws-carping.zip
    bundle_type: zip
    application: Carping-Backend
    deployment_group: CarpingGroup
    on: *2
    skip_cleanup: "true"
